<Window x:Class="FacturationMercuriale.Views.ArticlePickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Ajouter un article"
        Width="1100" Height="750"
        FontFamily="Calibri"
        FontSize="12"
        WindowStartupLocation="CenterOwner"
        Background="#F5F6F7">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="#34495E" Padding="20,15">
            <StackPanel>
                <TextBlock Text="SÉLECTION D'ARTICLES" FontSize="18" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Parcourez par rubriques ou utilisez la recherche globale" Foreground="#BDC3C7" FontSize="11"/>
            </StackPanel>
        </Border>

        <Grid Grid.Row="1" Margin="15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="320"/>
                <ColumnDefinition Width="20"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Padding="15">
                <StackPanel>
                    <TextBlock Text="RECHERCHE GLOBALE" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,10"/>
                    <TextBox x:Name="SearchBox" Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}" Padding="8,5" FontSize="14" Foreground="Black"/>

                    <Separator Margin="0,20" Background="#EEE"/>

                    <TextBlock Text="NAVIGATION PAR RUBRIQUE" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,10"/>

                    <TextBlock Text="Rubrique (Code - Désignation)" Margin="0,5,0,2" FontSize="11" Foreground="#555"/>
                    <ComboBox ItemsSource="{Binding Rubriques}" 
                              SelectedItem="{Binding SelectedRubrique}" 
                              DisplayMemberPath="Display" 
                              Padding="5" Foreground="Black">
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="Foreground" Value="Black"/>
                            </Style>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>

                    <TextBlock Text="Sous-Rubrique (Code - Désignation)" Margin="0,15,0,2" FontSize="11" Foreground="#555"/>
                    <ComboBox ItemsSource="{Binding SelectedRubrique.SousRubriques}" 
                              SelectedItem="{Binding SelectedSousRubrique}" 
                              DisplayMemberPath="Display" 
                              Padding="5" Foreground="Black">
                        <ComboBox.ItemContainerStyle>
                            <Style TargetType="ComboBoxItem">
                                <Setter Property="Foreground" Value="Black"/>
                            </Style>
                        </ComboBox.ItemContainerStyle>
                    </ComboBox>

                    <Button Content="Réinitialiser les filtres" Margin="0,30,0,0" Background="#95A5A6" Foreground="White" BorderThickness="0" Height="35" FontWeight="Bold" Click="ResetFilters_Click"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="2" Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="8" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0" Text="{Binding FilteredArticles.Count, StringFormat='\{0\} articles trouvés'}" FontStyle="Italic" Foreground="#7F8C8D" Margin="5,0,0,10"/>

                    <DataGrid Grid.Row="1" x:Name="ArticlesGrid" ItemsSource="{Binding FilteredArticles}" SelectedItem="{Binding SelectedArticle}" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True" GridLinesVisibility="Horizontal" RowHeight="35" BorderThickness="0" MouseDoubleClick="ArticlesGrid_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Référence" Binding="{Binding RefArticle}" Width="150"/>
                            <DataGridTextColumn Header="Désignation" Binding="{Binding DesignationFr}" Width="*">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Padding" Value="5,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                            <DataGridTextColumn Header="Conditionnement" Binding="{Binding Conditionnement}" Width="130"/>

                            <DataGridTextColumn Header="Prix HT (FCFA)" Binding="{Binding Prix, StringFormat=\{0:N0\}}" Width="120">
                                <DataGridTextColumn.ElementStyle>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="TextAlignment" Value="Right"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="Foreground" Value="#27AE60"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="Margin" Value="0,0,10,0"/>
                                    </Style>
                                </DataGridTextColumn.ElementStyle>
                            </DataGridTextColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </Border>
        </Grid>

        <Border Grid.Row="2" Background="#EBF5FB" BorderBrush="#AED6F1" BorderThickness="0,1,0,0" Padding="15,10">
            <TextBlock Text="💡 Astuce : Double-cliquez sur une ligne pour l'ajouter à la facture. La fenêtre reste ouverte." Foreground="#2E86C1"/>
        </Border>
    </Grid>
</Window>